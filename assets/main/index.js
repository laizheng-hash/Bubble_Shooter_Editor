System.register("chunks:///_virtual/AudioManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(s){var e,i,t,n,u;return{setters:[function(s){e=s.createClass},function(s){i=s.cclegacy,t=s._decorator,n=s.Node,u=s.AudioSource}],execute:function(){var o,c;i._RF.push({},"f5e4aPQORdAaIckTip2orY7","AudioManager",void 0);var _=t.ccclass;t.property,s("AudioManager",_("AudioManager")(((c=function(){function s(){this.bg_audio_source=null,this.sound_effects_sources=[],this.init_effects_sources_num=3,this.now_play_effect_count=0,this.init_params={},this.disable_bg_music=!1,this.disable_effect=!1}var i=s.prototype;return i.init=function(s,e){void 0===s&&(s=null),void 0===e&&(e=!1),this.init_params=s=Object.assign({bg_music_node_name:"bg_music",bg_music_clip:null,bg_volume:.8,parent_node:null},s);var i=new n(s.bg_music_node_name);i.parent=s.parent_node,this.bg_audio_source=i.addComponent(u);for(var t=0;t<this.init_effects_sources_num;t++){var o=new n(s.bg_music_node_name+"effect"+t);o.parent=s.parent_node,this.sound_effects_sources.push(o.addComponent(u))}return e&&this.startBgMusic(),this},i.startBgMusic=function(s){return void 0===s&&(s=null),!this.disable_bg_music&&(s=Object.assign({},this.init_params,s),this.bg_audio_source.clip=s.bg_music_clip,this.bg_audio_source.loop=!0,this.bg_audio_source.volume=s.bg_volume,this.bg_audio_source.play(),this)},i.pauseBgMusic=function(){return this.bg_audio_source.pause(),this},i.stopBgMusic=function(s){return this.bg_audio_source.stop(),s&&(this.disable_bg_music=!0),this},i.playSoundEffect=function(s,e){if(void 0===e&&(e=.6),this.disable_effect)return!1;var i=this.sound_effects_sources[this.now_play_effect_count%this.init_effects_sources_num];return i.volume=e,this.now_play_effect_count++,i.playOneShot(s,e),this},e(s,null,[{key:"instance",get:function(){return this._instance||(this._instance=new s),this._instance}}]),s}())._instance=void 0,o=c))||o);i._RF.pop()}}}));

System.register("chunks:///_virtual/BubbleCom.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,r,o;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,r=e._decorator,o=e.Component}],execute:function(){var c;n._RF.push({},"e55b4ThSM9JnIItu6CQBMOP","BubbleCom",void 0);var u=r.ccclass;r.property,e("BubbleCom",u("BubbleCom")(c=function(e){function n(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this).node=void 0,t.type=void 0,t.y=void 0,t.x=void 0,t}return t(n,e),n.create=function(e){var t=new n;return t.node=e,t},n.wrap=function(e){var t=this.create(e);return t.type=e.type,t},n}(o))||c);n._RF.pop()}}}));

System.register("chunks:///_virtual/CheckboxGroup.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Util.ts"],(function(t){var e,i,n,o,a,r,c,u,l,h;return{setters:[function(t){e=t.inheritsLoose},function(t){i=t.cclegacy,n=t._decorator,o=t.instantiate,a=t.Label,r=t.math,c=t.Node,u=t.Layout,l=t.Component},function(t){h=t.Util}],execute:function(){var s;i._RF.push({},"38d6eCnAyRHqq8kQdS78bGe","CheckboxGroup",void 0);var v=n.ccclass,p=(n.property,function(){function t(){this.is_multi=!1,this.is_vertical=!1,this.is_dark=void 0,this.options=[],this.value=null,this.parent_node=void 0,this.prefab=void 0,this.onchange=void 0}return t.create=function(e){e=e||{};var i=new t;for(var n in e)i[n]=e[n];return i},t}());t("CheckboxGroup",v("CheckboxGroup")(s=function(t){function i(){return t.apply(this,arguments)||this}return e(i,t),i.create=function(t){var e=this,i=p.create(t),n=i.is_multi?"checkbox":"radio",l=i.is_multi?"radio":"checkbox",s=o(i.prefab),v=s.getChildByPath("single_checkbox");v.active=!1,i.options.forEach((function(t){var u=o(v);u.name=t.value+"";var p=u.getChildByPath("round_btn/"+n),d=u.getChildByPath("round_btn/"+l);p.active=!0,p.getChildByPath("active").active=i.value===t.value,d.active=!1;var f=u.getChildByPath("label").getComponent(a);f.string=t.text||t.value,f.color=i.is_dark?h.getColor("#333333"):r.Color.WHITE,u.parent=s,u.active=!0,u.on(c.EventType.TOUCH_END,(function(){i.onchange&&i.onchange(t.value),s.children.forEach((function(e){e.getChildByPath("round_btn/"+n+"/active").active=t.value+""===e.name}))}),e)}));var d=s.getComponent(u);return d.alignHorizontal=!i.is_vertical,d.alignVertical=i.is_vertical,d.type=i.is_vertical?2:1,s.parent=i.parent_node,s},i.prototype.update=function(t){},i}(l))||s);i._RF.pop()}}}));

System.register("chunks:///_virtual/clearEffectEditor.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,i,o,r,s,a,d,h,l,c,p,g;return{setters:[function(e){t=e.inheritsLoose},function(e){n=e.cclegacy,i=e._decorator,o=e.Node,r=e.TweenSystem,s=e.tween,a=e.Label,d=e.EditBox,h=e.Sprite,l=e.UIOpacity,c=e.Animation,p=e.instantiate,g=e.Component}],execute:function(){var u;n._RF.push({},"56c0fdZ9QJL+rPUPqLlo2Fu","clearEffectEditor",void 0);var m=i.ccclass;i.property,e("clearEffectEditor",m("clearEffectEditor")(u=function(e){function n(){for(var t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))||this).types=["掉落","消失","爆炸"],t.type="掉落",t.interval=.05,t.speed=1,t.cleared=[],t}t(n,e);var i=n.prototype;return i.onLoad=function(){var e=this;this.node.on(o.EventType.TOUCH_START,(function(){e.node.active=!1,r.instance.ActionManager.removeActionByTag(111)}),this)},i.onEnable=function(){var e=this;s(this).call((function(){e.clearBall(e.node.getChildByName("demo").children[4].children[1])})).delay(3).call(this.resetBalls.bind(this)).delay(1).union().repeatForever().tag(111).start()},i.init=function(e){this.type=e.type,this.interval=e.interval,this.speed=e.speed,this.node.getChildByPath("Button").children[0].getComponent(a).string=this.type,this.node.getChildByName("EditBox").getComponent(d).string=this.interval.toString(),this.node.getChildByName("EditBox-001").getComponent(d).string=this.speed.toString()},i.getEffectSetting=function(){return{type:this.type,interval:this.interval,speed:this.speed}},i.shaftType=function(e){var t=this.types.indexOf(this.type);(t+=1)>=this.types.length&&(t=0),this.type=this.types[t],e.target.children[0].getComponent(a).string=this.type},i.EditBoxEvent=function(e,t){this[t]=Number(e.string)},i.resetBalls=function(){this.node.getChildByName("demo").children.forEach((function(e){e.children.forEach((function(e){e.getComponent(h).enabled=!0,e.getComponent(l)&&(e.getComponent(l).opacity=255)}))})),this.cleared=[]},i.clearBall=function(e){var t=this;switch(this.cleared.push(e),this.type){case"掉落":var n=p(e);this.node.addChild(n),n.setWorldPosition(e.getWorldPosition());var i=0;e.getComponent(h).enabled=!1,s(n).to(5/this.speed,{},{onUpdate:function(e,t){i+=10*t;var o=n.getPosition();o.y-=i*t,n.setPosition(o)}}).call((function(){n.destroy()})).start();break;case"消失":s(e.getComponent(l)).to(1/this.speed,{opacity:0}).start();break;case"爆炸":e.getComponent(h).enabled=!1,e.children[0].getComponent(c).getState("bomb").speed=this.speed,e.children[0].getComponent(c).play()}var o=this.getNeighbor(e.getSiblingIndex(),e.parent.getSiblingIndex());this.scheduleOnce((function(){o.forEach((function(e){t.clearBall(e)}))}),this.interval)},i.getNeighbor=function(e,t){var n=this,i=[],o=t%2==0?e-1:e;return t>0&&(i.push(this.node.getChildByName("demo").children[t-1].children[o]),i.push(this.node.getChildByName("demo").children[t-1].children[o+1])),i.push(this.node.getChildByName("demo").children[t].children[e-1]),i.push(this.node.getChildByName("demo").children[t].children[e+1]),t<4&&(i.push(this.node.getChildByName("demo").children[t+1].children[o]),i.push(this.node.getChildByName("demo").children[t+1].children[o+1])),i=i.filter((function(i){return(!i||i.getComponent(h).spriteFrame.name==n.node.getChildByName("demo").children[t].children[e].getComponent(h).spriteFrame.name)&&(!(i&&n.cleared.indexOf(i)>0)&&!!i)}))},n}(g))||u);n._RF.pop()}}}));

System.register("chunks:///_virtual/CrossEdgePosCom.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(o){var s,t,e,r;return{setters:[function(o){s=o.inheritsLoose},function(o){t=o.cclegacy,e=o._decorator,r=o.Component}],execute:function(){var i;t._RF.push({},"0a49a09LVZNepk5v6t/bTUf","CrossEdgePosCom",void 0);var n=e.ccclass;e.property,o("CrossEdgePosCom",n("CrossEdgePosCom")(i=function(o){function t(){for(var s,t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return(s=o.call.apply(o,[this].concat(e))||this).start_pos=void 0,s.line_start_pos=void 0,s.relative_pos=void 0,s.end_pos=void 0,s.cross_pos=void 0,s.is_top=void 0,s.attach_bubble_com=void 0,s.attach_aid_pos=void 0,s}return s(t,o),t}(r))||i);t._RF.pop()}}}));

System.register("chunks:///_virtual/CurvePathCalc.ts",["cc","./Util.ts"],(function(t){var n,i,e,r;return{setters:[function(t){n=t.cclegacy,i=t._decorator,e=t.Vec3},function(t){r=t.Util}],execute:function(){var s;n._RF.push({},"39b70pbPNVJs5nMIMCCCdhG","CurvePathCalc",void 0);var c=i.ccclass;i.property,t("CurvePathCalc",c("CurvePathCalc")(s=function(){function t(){this.points_list=[],this.points_direction_list=[],this.points_distance_list=[],this.current_pos_index=0,this.current_direction=void 0,this.current_pos=void 0,this.is_finished=!1,this.current_occupied_len=0}t.create=function(n,i){void 0===i&&(i=!1);var s=new t;if(n=n.map((function(t){return t instanceof e||(t=r.getVec3ByJsonObj(t)),t})),s.points_list=n,i){var c=this.bindDistanceAndDirectionList(s.points_list),o=c.points_distance_list,_=c.points_direction_list;s.points_distance_list=o,s.points_direction_list=_}return s},t.bindDistanceAndDirectionList=function(t){for(var n=[],i=[],e=0;e<t.length-1;e++){var s=r.getVec3ByJsonObj(t[e]),c=r.getVec3ByJsonObj(t[e+1]).subtract(s);i.push(c.length()),n.push(c)}return{points_distance_list:i,points_direction_list:n}};var n=t.prototype;return n.initFirstPoint=function(){var t=this.points_list[this.current_pos_index],n=this.points_list[this.current_pos_index+1].clone().subtract(t);this.current_direction=n.normalize(),this.current_pos=t},n.getPrevPosData=function(t){for(var n=this.current_occupied_len,i=0,e={current_occupied_len:null,current_pos_index:null,current_direction:null,current_pos:null},s=this.current_pos_index;s>=0;s--){var c=r.getVec3ByJsonObj(this.points_list[s]),o=(this.points_direction_list[s],this.points_distance_list[s]),_=r.getVec3ByJsonObj(this.points_list[s+1]),u=n>0?n:o;if(i+u>t){n=i+u-t;var l=r.getVec3ByJsonObj({x:c.x+(_.x-c.x)*n/o,y:c.y+(_.y-c.y)*n/o,z:c.z+(_.z-c.z)*n/o});return e.current_occupied_len=n,e.current_pos_index=s,e.current_direction=_.subtract(c),e.current_pos=l,e}i+=u,s===this.current_pos_index&&(n=0)}return null},n.getNextPosData=function(t){for(var n=this.current_occupied_len,i=0,e={current_occupied_len:null,current_pos_index:null,current_direction:null,current_pos:null},s=this.current_pos_index;s<this.points_list.length-1;s++){var c=r.getVec3ByJsonObj(this.points_list[s]),o=(this.points_direction_list[s],this.points_distance_list[s]),_=r.getVec3ByJsonObj(this.points_list[s+1]),u=o-n;if(i+u>t){n=o-(i+u-t);var l=r.getVec3ByJsonObj({x:c.x+(_.x-c.x)*n/o,y:c.y+(_.y-c.y)*n/o,z:c.z+(_.z-c.z)*n/o});return e.current_occupied_len=n,e.current_pos_index=s,e.current_direction=_.subtract(c),e.current_pos=l,e}i+=u,s===this.current_pos_index&&(n=0)}return null},n.cloneCurrentData=function(t){this.current_occupied_len=t.current_occupied_len,this.current_pos=t.current_pos.clone(),this.current_direction=t.current_direction.clone(),this.current_pos_index=t.current_pos_index},n.setCurrentDataByRes=function(t){this.is_finished=!1,this.current_occupied_len=t.current_occupied_len,this.current_pos=t.current_pos.clone(),this.current_direction=t.current_direction.clone(),this.current_pos_index=t.current_pos_index},n.moveForward=function(t){var n=this.getNextPosData(t);return n?this.setCurrentDataByRes(n):this.is_finished=!0,this},n.lastPoint=function(){return this.points_list[this.points_list.length-1]},t}())||s);n._RF.pop()}}}));

System.register("chunks:///_virtual/debug-view-runtime-control.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,o,i,n,s,l,r,a,g,h,p,c,C,d,m,u,L;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inheritsLoose,i=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){s=t.cclegacy,l=t._decorator,r=t.Node,a=t.Color,g=t.Canvas,h=t.UITransform,p=t.instantiate,c=t.Label,C=t.RichText,d=t.Toggle,m=t.Button,u=t.director,L=t.Component}],execute:function(){var f,M,b,v,T,S,x,E,I;s._RF.push({},"b2bd1+njXxJxaFY3ymm06WU","debug-view-runtime-control",void 0);var A=l.ccclass,y=l.property;t("DebugViewRuntimeControl",(f=A("internal.DebugViewRuntimeControl"),M=y(r),b=y(r),v=y(r),f((x=e((S=function(t){function e(){for(var e,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return e=t.call.apply(t,[this].concat(s))||this,i(e,"compositeModeToggle",x,n(e)),i(e,"singleModeToggle",E,n(e)),i(e,"EnableAllCompositeModeButton",I,n(e)),e._single=0,e.strSingle=["No Single Debug","Vertex Color","Vertex Normal","Vertex Tangent","World Position","Vertex Mirror","Face Side","UV0","UV1","UV Lightmap","Project Depth","Linear Depth","Fragment Normal","Fragment Tangent","Fragment Binormal","Base Color","Diffuse Color","Specular Color","Transparency","Metallic","Roughness","Specular Intensity","IOR","Direct Diffuse","Direct Specular","Direct All","Env Diffuse","Env Specular","Env All","Emissive","Light Map","Shadow","AO","Fresnel","Direct Transmit Diffuse","Direct Transmit Specular","Env Transmit Diffuse","Env Transmit Specular","Transmit All","Direct Internal Specular","Env Internal Specular","Internal All","Fog"],e.strComposite=["Direct Diffuse","Direct Specular","Env Diffuse","Env Specular","Emissive","Light Map","Shadow","AO","Normal Map","Fog","Tone Mapping","Gamma Correction","Fresnel","Transmit Diffuse","Transmit Specular","Internal Specular","TT"],e.strMisc=["CSM Layer Coloration","Lighting With Albedo"],e.compositeModeToggleList=[],e.singleModeToggleList=[],e.miscModeToggleList=[],e.textComponentList=[],e.labelComponentList=[],e.textContentList=[],e.hideButtonLabel=void 0,e._currentColorIndex=0,e.strColor=["<color=#ffffff>","<color=#000000>","<color=#ff0000>","<color=#00ff00>","<color=#0000ff>"],e.color=[a.WHITE,a.BLACK,a.RED,a.GREEN,a.BLUE],e}o(e,t);var s=e.prototype;return s.start=function(){if(this.node.parent.getComponent(g)){var t=this.node.parent.getComponent(h),e=.5*t.width,o=.5*t.height,i=.1*e-e,n=o-.1*o,s=this.node.getChildByName("MiscMode"),l=p(s);l.parent=this.node,l.name="Buttons";var r=p(s);r.parent=this.node,r.name="Titles";for(var u=0;u<2;u++){var L=p(this.EnableAllCompositeModeButton.getChildByName("Label"));L.setPosition(i+(u>0?450:150),n,0),L.setScale(.75,.75,.75),L.parent=r;var f=L.getComponent(c);f.string=u?"----------Composite Mode----------":"----------Single Mode----------",f.color=a.WHITE,f.overflow=0,this.labelComponentList[this.labelComponentList.length]=f}n-=20;for(var M=0,b=0;b<this.strSingle.length;b++,M++){b===this.strSingle.length>>1&&(i+=200,M=0);var v=b?p(this.singleModeToggle):this.singleModeToggle;v.setPosition(i,n-20*M,0),v.setScale(.5,.5,.5),v.parent=this.singleModeToggle.parent;var T=v.getComponentInChildren(C);T.string=this.strSingle[b],this.textComponentList[this.textComponentList.length]=T,this.textContentList[this.textContentList.length]=T.string,v.on(d.EventType.TOGGLE,this.toggleSingleMode,this),this.singleModeToggleList[b]=v}i+=200,this.EnableAllCompositeModeButton.setPosition(i+15,n,0),this.EnableAllCompositeModeButton.setScale(.5,.5,.5),this.EnableAllCompositeModeButton.on(m.EventType.CLICK,this.enableAllCompositeMode,this),this.EnableAllCompositeModeButton.parent=l;var S=this.EnableAllCompositeModeButton.getComponentInChildren(c);this.labelComponentList[this.labelComponentList.length]=S;var x=p(this.EnableAllCompositeModeButton);x.setPosition(i+90,n,0),x.setScale(.5,.5,.5),x.on(m.EventType.CLICK,this.changeTextColor,this),x.parent=l,(S=x.getComponentInChildren(c)).string="TextColor",this.labelComponentList[this.labelComponentList.length]=S;var E=p(this.EnableAllCompositeModeButton);E.setPosition(i+200,n,0),E.setScale(.5,.5,.5),E.on(m.EventType.CLICK,this.hideUI,this),E.parent=this.node.parent,(S=E.getComponentInChildren(c)).string="Hide UI",this.labelComponentList[this.labelComponentList.length]=S,this.hideButtonLabel=S,n-=40;for(var I=0;I<this.strMisc.length;I++){var A=p(this.compositeModeToggle);A.setPosition(i,n-20*I,0),A.setScale(.5,.5,.5),A.parent=s;var y=A.getComponentInChildren(C);y.string=this.strMisc[I],this.textComponentList[this.textComponentList.length]=y,this.textContentList[this.textContentList.length]=y.string,A.getComponent(d).isChecked=!!I,A.on(d.EventType.TOGGLE,I?this.toggleLightingWithAlbedo:this.toggleCSMColoration,this),this.miscModeToggleList[I]=A}n-=150;for(var D=0;D<this.strComposite.length;D++){var B=D?p(this.compositeModeToggle):this.compositeModeToggle;B.setPosition(i,n-20*D,0),B.setScale(.5,.5,.5),B.parent=this.compositeModeToggle.parent;var w=B.getComponentInChildren(C);w.string=this.strComposite[D],this.textComponentList[this.textComponentList.length]=w,this.textContentList[this.textContentList.length]=w.string,B.on(d.EventType.TOGGLE,this.toggleCompositeMode,this),this.compositeModeToggleList[D]=B}}else console.error("debug-view-runtime-control should be child of Canvas")},s.isTextMatched=function(t,e){var o=new String(t),i=o.search(">");return-1===i?t===e:(o=(o=o.substr(i+1)).substr(0,o.search("<")))===e},s.toggleSingleMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strSingle.length;i++)this.isTextMatched(o.string,this.strSingle[i])&&(e.singleMode=i)},s.toggleCompositeMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strComposite.length;i++)this.isTextMatched(o.string,this.strComposite[i])&&e.enableCompositeMode(i,t.isChecked)},s.toggleLightingWithAlbedo=function(t){u.root.debugView.lightingWithAlbedo=t.isChecked},s.toggleCSMColoration=function(t){u.root.debugView.csmLayerColoration=t.isChecked},s.enableAllCompositeMode=function(t){var e=u.root.debugView;e.enableAllCompositeMode(!0);for(var o=0;o<this.compositeModeToggleList.length;o++){this.compositeModeToggleList[o].getComponent(d).isChecked=!0}var i=this.miscModeToggleList[0].getComponent(d);i.isChecked=!1,e.csmLayerColoration=!1,(i=this.miscModeToggleList[1].getComponent(d)).isChecked=!0,e.lightingWithAlbedo=!0},s.hideUI=function(t){var e=this.node.getChildByName("Titles"),o=!e.active;this.singleModeToggleList[0].parent.active=o,this.miscModeToggleList[0].parent.active=o,this.compositeModeToggleList[0].parent.active=o,this.EnableAllCompositeModeButton.parent.active=o,e.active=o,this.hideButtonLabel.string=o?"Hide UI":"Show UI"},s.changeTextColor=function(t){this._currentColorIndex++,this._currentColorIndex>=this.strColor.length&&(this._currentColorIndex=0);for(var e=0;e<this.textComponentList.length;e++)this.textComponentList[e].string=this.strColor[this._currentColorIndex]+this.textContentList[e]+"</color>";for(var o=0;o<this.labelComponentList.length;o++)this.labelComponentList[o].color=this.color[this._currentColorIndex]},s.onLoad=function(){},s.update=function(t){},e}(L)).prototype,"compositeModeToggle",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(S.prototype,"singleModeToggle",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(S.prototype,"EnableAllCompositeModeButton",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=S))||T));s._RF.pop()}}}));

System.register("chunks:///_virtual/DrawHelper.ts",["cc","./Util.ts"],(function(r){var t,i,e,o,n,c;return{setters:[function(r){t=r.cclegacy,i=r._decorator,e=r.Node,o=r.Graphics,n=r.UITransform},function(r){c=r.Util}],execute:function(){var s,a;t._RF.push({},"bc690kOqldFZbJFPB4OlAHj","DrawHelper",void 0);var p=i.ccclass;i.property,r("DrawHelper",p("DrawHelper")(((a=function(){function r(){}return r.init=function(r){var t=new e;return t.parent=r,this.parent=r,this.graphics=t.addComponent(o),this},r.circle=function(r,t,i,e){void 0===t&&(t=30),void 0===i&&(i=0),void 0===e&&(e=1);var o=this.parent.getComponent(n).convertToNodeSpaceAR(r);return this.graphics.circle(o.x,o.y,t),this.graphics.fillColor=c.getColor(this.color_map[i],e),this.graphics.stroke(),this.graphics.fill(),this},r.clear=function(){return this.graphics.clear(),this},r.line=function(r,t,i){var e=this;void 0===t&&(t=2),void 0===i&&(i=2);var o=this.parent.getComponent(n).convertToNodeSpaceAR(r[0]);return this.graphics.lineWidth=t,this.graphics.strokeColor=this.color_map[i],this.graphics.moveTo(o.x,o.y),r.forEach((function(r,t){if(0===t)return!1;var i=e.parent.getComponent(n).convertToNodeSpaceAR(r);e.graphics.lineTo(i.x,i.y)})),this.graphics.stroke(),this},r}()).graphics=void 0,a.parent=void 0,a.color_map={0:"#ffffff",1:"#000000",2:"#0000FF",3:"#00FF00",4:"#FFA500",5:"#A020F0",6:"#FF0000",7:"#00CED1",8:"#8B4513"},s=a))||s);t._RF.pop()}}}));

System.register("chunks:///_virtual/editor.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ModalHelper.ts","./line.ts","./ResourceHelper.ts","./clearEffectEditor.ts","./stage_editor.ts","./moveEditor.ts","./video.ts"],(function(e){var t,n,i,o,r,l,a,c,d,u,s,f,p,h,g,v,m,y,C,b,E,_,B,S;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,l=e._decorator,a=e.Node,c=e.Button,d=e.instantiate,u=e.Label,s=e.v3,f=e.Sprite,p=e.Texture2D,h=e.ImageAsset,g=e.SpriteFrame,v=e.Component},function(e){m=e.ModalHelper},function(e){y=e.line},function(e){C=e.ResourceHelper},function(e){b=e.clearEffectEditor},function(e){E=e.eventTarget,_=e.GlobalData},function(e){B=e.moveEditor},function(e){S=e.video}],execute:function(){var A,P,L,T,w,F,N;r._RF.push({},"1abf9qt5+lPmot4Ip8DA6CF","editor",void 0);var R=l.ccclass,I=l.property;e("editor",(A=R("editor"),P=I(a),L=I(a),A((F=t((w=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return t=e.call.apply(e,[this].concat(r))||this,i(t,"targetNode",F,o(t)),i(t,"bubble_panel",N,o(t)),t.line_arr=["类型1","类型2","类型3","类型4"],t.current_line=0,t.current_ballArr=[],t.clearEffect=void 0,t.move=void 0,t.flySpeed=20,t}n(t,e);var r=t.prototype;return r.init=function(e){var t=this;this.updateLine(e.line),this.updateBallArr(e.ballArr),this.clearEffect=e.clearEffect,this.move=e.move,this.node.getChildByPath("clearEffect/detail").getComponent(b).init(this.clearEffect),this.node.getChildByPath("moveType/detail").getComponent(B).init(this.move);var n=this.line_arr.map((function(e,t){return{text:e,value:t}}));this.node.getChildByPath("line/Button").on(c.EventType.CLICK,(function(){m.radio(n,(function(e){t.updateLine(e)}),t.current_line,{title:"选择瞄准线类型",radio_is_dark:!0,radio_is_vertical:!0})})),this.node.getChildByPath("ballArr/Layout").children.forEach((function(e,n){e.on(a.EventType.TOUCH_START,(function(e){var n=e.target.getSiblingIndex(),i=[].concat(t.current_ballArr);i[n]+=1,8==i[n]&&(i[n]=0),t.updateBallArr(i)}),t)}))},r.getSetting=function(){return{line:this.current_line,ballArr:this.current_ballArr,clearEffect:this.node.getChildByPath("clearEffect/detail").getComponent(b).getEffectSetting(),move:this.node.getChildByPath("moveType/detail").getComponent(B).getMoveSetting(),flySpeed:this.flySpeed}},r.EditBoxEvent=function(e,t){this[t]=Number(e.string)},r.SliderEvent=function(e){var t=this.node.getChildByPath("moveType/detail").getComponent(B).posY+1920*(1-e.progress);E.emit("updatePanel",t)},r.initClearEffect=function(){this.node.getChildByPath("clearEffect/detail").active=!0},r.initMove=function(){this.node.getChildByPath("moveType/detail").active=!0},r.updateLine=function(e){if(e!=this.current_line){console.log(e),this.node.getChildByPath("launcher/line").destroy();var t=d(C.prefab("line"+e));t.name="line",this.node.getChildByName("launcher").addChild(t),t.setPosition(0,50),this.node.getChildByPath("line/stage/name").getComponent(u).string="类型"+(e+1),t.getComponent(y).clearLine(),t.getComponent(y).drawLine([s(810,632),s(810,1e3)])}else this.node.getChildByPath("launcher/line").getComponent(y).drawLine([s(810,632),s(810,1e3)]);this.current_line=e},r.updateBallArr=function(e){var t=this;this.node.getChildByPath("ballArr/Layout").children.forEach((function(n,i){e[i]!=t.current_ballArr[i]&&(n.getComponent(f).spriteFrame=C.img("bubble"+e[i]))})),this.current_ballArr=e},r.onChooseFile=function(){var e=this,t=document.createElement("input");t.type="file",t.accept="video/*,image/*",t.style.display="none",t.onchange=function(t){var n=t.target,i=n.files?n.files[0]:null;if(i){var o,r=i.type.split("/")[0];null==(o=i.name.split(".").pop())||o.toLowerCase();"image"===r?e.loadImage(i):"video"===r?e.loadVideo(i):console.log("不支持的文件类型")}},document.body.appendChild(t),t.click(),document.body.removeChild(t)},r.loadImage=function(e){var t=this,n=new FileReader;n.onload=function(e){var n,i=null==(n=e.target)?void 0:n.result,o=new Image;o.src=i,o.onload=function(){var e=new p,n=new h(o);if(e.image=n,t.targetNode){var i=t.targetNode.getComponent(f);if(i){var r=new g;r.texture=e,i.spriteFrame=r,_.bgSp=r,_.url=null}else console.log("目标节点未找到 Sprite 组件")}}},n.readAsDataURL(e)},r.loadVideo=function(e){if(this.targetNode){var t=URL.createObjectURL(e);this.targetNode.getComponent(S).loadVideo(t),_.bgSp=null,_.url=t}else console.log("未设置目标节点")},r.openFileSelector=function(){var e=this,t=document.createElement("input");t.type="file",t.accept=".json",t.style.display="none",t.addEventListener("change",(function(t){var n,i=null==(n=t.target.files)?void 0:n[0];i&&e.readFile(i)})),t.click()},r.readFile=function(e){var t=new FileReader;t.onload=function(e){var t,n=null==(t=e.target)?void 0:t.result;try{var i=JSON.parse(n);console.log("读取的 JSON 数据：",i),E.emit("updateStage",i)}catch(e){console.error("JSON 解析失败：",e)}},t.readAsText(e)},t}(v)).prototype,"targetNode",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=t(w.prototype,"bubble_panel",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=w))||T));r._RF.pop()}}}));

System.register("chunks:///_virtual/Form.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Util.ts","./CheckboxGroup.ts","./ResourceHelper.ts"],(function(e){var r,t,o,a,n,i,c,s,u,l;return{setters:[function(e){r=e.inheritsLoose},function(e){t=e.cclegacy,o=e._decorator,a=e.instantiate,n=e.Label,i=e.math,c=e.Component},function(e){s=e.Util},function(e){u=e.CheckboxGroup},function(e){l=e.ResourceHelper}],execute:function(){var p;t._RF.push({},"a5a0c6jcIRJXbNBlTD7CU81","Form",void 0);var f=o.ccclass,v=(o.property,function(){function e(){this.form_params={default:{label:"",value:null,type:"radio",options:[],is_vertical:!1,is_dark:!1}},this.parent_node=void 0,this.prefab=void 0,this.onchange=void 0,this.is_dark=!1}return e.create=function(r){r=r||{};var t=new e;for(var o in r)t[o]=r[o];return t},e}());e("Form",f("Form")(p=function(e){function t(){return e.apply(this,arguments)||this}return r(t,e),t.create=function(e){var r=v.create(e),t=a(r.prefab),o=t.getChildByPath("form_item_wrap");for(var c in o.active=!1,r.form_params){var u=r.form_params[c],l=a(o);l.name=c;var p=l.getChildByPath("label").getComponent(n);p.string=u.label+" :",p.color=r.is_dark?s.getColor("#555555"):i.Color.WHITE,this.createSingleCheckbox(u,l,r),l.parent=t,l.active=!0}return t.parent=r.parent_node,t.active=!0,t},t.createSingleCheckbox=function(e,r,t){var o=this;u.create({options:e.options,value:e.value,type:e.type,parent_node:r,is_vertical:e.is_vertical,is_dark:t.is_dark,prefab:l.prefab("checkbox_group"),onchange:function(r){e.value=r,t.onchange&&t.onchange(o.formParamsFormat(t)),console.log(r)}})},t.formParamsFormat=function(e){var r={};for(var t in e.form_params)r[t]=e.form_params[t].value;return r},t.prototype.update=function(e){},t}(c))||p);t._RF.pop()}}}));

System.register("chunks:///_virtual/line.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var e,t,o,r,c;return{setters:[function(n){e=n.inheritsLoose},function(n){t=n.cclegacy,o=n._decorator,r=n.Vec3,c=n.Component}],execute:function(){var i;t._RF.push({},"94a8b+IZ1lJb5oqNesjwqtl","line",void 0);var l=o.ccclass;o.property,n("line",l("line")(i=function(n){function t(){for(var e,t=arguments.length,o=new Array(t),c=0;c<t;c++)o[c]=arguments[c];return(e=n.call.apply(n,[this].concat(o))||this).touch_panel_pos={top:null,right:null,bottom:new r(1350,480),left:new r(270,480)},e}e(t,n);var o=t.prototype;return o.drawLine=function(n){},o.clearLine=function(){this.node.children.forEach((function(n){n.active=!1}))},t}(c))||i);t._RF.pop()}}}));

System.register("chunks:///_virtual/line0.ts",["./rollupPluginModLoBabelHelpers.js","cc","./line.ts"],(function(n){var t,e,i,r,o;return{setters:[function(n){t=n.inheritsLoose},function(n){e=n.cclegacy,i=n._decorator,r=n.instantiate},function(n){o=n.line}],execute:function(){var c;e._RF.push({},"42c36qXdWtCEZkQcmd3JMoy","line0",void 0);var l=i.ccclass;i.property,n("line0",l("line0")(c=function(n){function e(){return n.apply(this,arguments)||this}return t(e,n),e.prototype.drawLine=function(n){for(var t=0,e=0;e<n.length-1;e++){var i=n[e],o=n[e+1];i.z=0;for(var c=o.clone().subtract(i),l=0;l<Math.round(c.length()/40);l++){var a=this.node.children[t++];a||(a=r(this.node.children[0]),this.node.addChild(a));var s=i.clone().add(c.clone().normalize().multiplyScalar(40*l));a.setWorldPosition(s),a.active=!0}}},e}(o))||c);e._RF.pop()}}}));

System.register("chunks:///_virtual/line1.ts",["./rollupPluginModLoBabelHelpers.js","cc","./line.ts"],(function(e){var n,t,o,r,i,c;return{setters:[function(e){n=e.inheritsLoose},function(e){t=e.cclegacy,o=e._decorator,r=e.UITransform,i=e.Graphics},function(e){c=e.line}],execute:function(){var s;t._RF.push({},"4abectrUZhJsI0xrWI5bit7","line1",void 0);var a=o.ccclass;o.property,e("line1",a("line1")(s=function(e){function t(){return e.apply(this,arguments)||this}n(t,e);var o=t.prototype;return o.drawLine=function(e){for(var n=0;n<e.length;n++)e[n]=this.node.getComponent(r).convertToNodeSpaceAR(e[n]);var t=this.node.getComponent(i);t.moveTo(e[0].x,e[0].y);for(var o=1;o<e.length;o++)t.lineTo(e[o].x,e[o].y);t.stroke()},o.clearLine=function(){this.node.getComponent(i).clear()},t}(c))||s);t._RF.pop()}}}));

System.register("chunks:///_virtual/line2.ts",["./rollupPluginModLoBabelHelpers.js","cc","./line.ts"],(function(e){var n,t,r,i,o,l,c;return{setters:[function(e){n=e.inheritsLoose},function(e){t=e.cclegacy,r=e._decorator,i=e.v2,o=e.math,l=e.instantiate},function(e){c=e.line}],execute:function(){var a;t._RF.push({},"8e7a2shc25FNI5SuNGP+gyk","line2",void 0);var s=r.ccclass;r.property,e("line2",s("line2")(a=function(e){function t(){return e.apply(this,arguments)||this}return n(t,e),t.prototype.drawLine=function(e){for(var n=0,t=0;t<e.length-1;t++){var r=e[t],c=e[t+1],a=c.clone().subtract(r.clone()),s=i(0,1).signAngle(i(a.x,a.y)),u=o.toDegree(s);r.z=0;for(var d=c.clone().subtract(r),h=0;h<Math.round(d.length()/40);h++){var p=this.node.children[n++];p||(p=l(this.node.children[0]),this.node.addChild(p)),p.angle=u;var v=r.clone().add(d.clone().normalize().multiplyScalar(40*h));p.setWorldPosition(v),p.active=!0}}},t}(c))||a);t._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./debug-view-runtime-control.ts","./clearEffectEditor.ts","./AudioManager.ts","./CheckboxGroup.ts","./CurvePathCalc.ts","./DrawHelper.ts","./Form.ts","./MathCalc.ts","./ModalHelper.ts","./PoolManager.ts","./ResourceHelper.ts","./Util.ts","./BubbleCom.ts","./CrossEdgePosCom.ts","./StageJson.ts","./editor.ts","./line.ts","./line0.ts","./line1.ts","./line2.ts","./moveEditor.ts","./play.ts","./stage_editor.ts","./video.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/MathCalc.ts",["cc"],(function(n){var t,e,r,a,i;return{setters:[function(n){t=n.cclegacy,e=n._decorator,r=n.Vec3,a=n.Intersection2D,i=n.v2}],execute:function(){var o;t._RF.push({},"4bf8fqx45BJmIYotQfNcXGY","MathCalc",void 0);var s=e.ccclass;e.property,n("MathCalc",s("MathCalc")(o=function(){function n(){}return n.getMinDistanceInOnePointAndOneLine=function(n,t,e){var a=this.getPedalPoint(n,t,e);return new r(a).subtract(e).length()},n.getMinDistanceInOnePointAndLineSegment=function(n,t,e){var a=this.getPedalPoint(n,t,e),i=[n,t];this.onePointIsInTwoPoints(n,t,a)&&i.push(a);var o=null;return i.forEach((function(n){var t=new r(n).subtract(e).length();(null===o||t<o)&&(o=t)})),o},n.onePointIsInTwoPoints=function(n,t,e){var r=.01;return e.x>=Math.min(n.x,t.x)-r&&e.x<=Math.max(n.x,t.x)+r&&e.y>=Math.min(n.y,t.y)-r&&e.y<=Math.max(n.y,t.y)+r},n.getPedalPoint=function(n,t,e){var a=e.y,i=e.x,o=this.getLineParams(n,t),s=o.A,c=o.B,u=o.C,h=new r;return h.x=(c*c*i-s*c*a-s*u)/(s*s+c*c),h.y=(s*s*a-s*c*i-c*u)/(s*s+c*c),h},n.findFirstIntersection=function(n,t,e,r){var o=a.pointLineDistance(i(e.x,e.y),i(n.x,n.y),i(t.x,t.y),!1),s=Math.abs(Math.sqrt(r*r-o*o)),c=this.getPedalPoint(n,t,e);return c.multiplyScalar(1-s/c.length())},n.raySegmentIntersection=function(n,t,e,a){var i=new r;r.subtract(i,a,e);var o=new r;r.cross(o,t,i);var s=o.lengthSqr();if(s<1e-6)return null;var c=new r;r.subtract(c,e,n);var u=r.dot(r.cross(new r,c,i),o)/s,h=r.dot(r.cross(new r,c,t),o)/s;if(u>=0&&h>=0&&h<=1){var y=new r;return r.scaleAndAdd(y,n,t,u),y}return null},n.getLineParams=function(n,t){var e=n.y,r=n.x,a=t.y,i=t.x;return{A:a-e,B:r-i,C:i*e-r*a}},n.getPosByRayAndStartPos=function(n,t,e){var a=Math.atan2(n.y-t.y,n.x-t.x);return new r(n.x-e*Math.cos(a),n.y-e*Math.sin(a),0)},n.getAngleByDirection=function(n){return 180*Math.atan2(n.y,n.x)/Math.PI},n.getTwoLineCrossPointPos=function(n,t,e,a){var i=this.getLineParams(n,t),o=this.getLineParams(e,a),s=i.A*o.B-i.B*o.A;return 0===s?null:new r((i.B*o.C-i.C*o.B)/s,(i.C*o.A-i.A*o.C)/s,0)},n.getNormalLineParams=function(n,t){var e=n.A,r=n.B;n.C;return{A:r,B:-e,C:-r*t.x+e*t.y}},n.getSymmetryPointByOneLineAndOnePoint=function(n,t){var e=n.A,a=n.B,i=n.C,o=t.x,s=t.y,c=(e*o+a*s+i)/(Math.pow(e,2)+Math.pow(a,2));return new r(o-2*e*c,s-2*a*c,0)},n.getOneLegByOtherLegAndHypotenuse=function(n,t){return Math.sqrt(Math.pow(t,2)-Math.pow(n,2))},n}())||o);t._RF.pop()}}}));

System.register("chunks:///_virtual/ModalHelper.ts",["cc","./CheckboxGroup.ts","./ResourceHelper.ts","./Form.ts"],(function(t){var e,n,o,a,l,i,c,d,r;return{setters:[function(t){e=t.cclegacy,n=t._decorator,o=t.instantiate,a=t.Button,l=t.Label,i=t.UITransform},function(t){c=t.CheckboxGroup},function(t){d=t.ResourceHelper},function(t){r=t.Form}],execute:function(){var h,_;e._RF.push({},"6f10ejLCxNNao7f2OZMy9VQ","ModalHelper",void 0);var s=n.ccclass;n.property,t("ModalHelper",s("ModalHelper")(((_=function(){function t(){}return t.init=function(t){var e=this;t=Object.assign({parent_node:null,prefab:null},t),this.modal_node=o(t.prefab),this.modal_node.parent=t.parent_node,this.modal_node.getChildByPath("panel/footer/btn_cancel_wrap/btn").on(a.EventType.CLICK,(function(){e.modal_cancel_callback&&e.modal_cancel_callback()}),this),this.modal_node.getChildByPath("panel/footer/btn_primary_wrap/btn").on(a.EventType.CLICK,(function(){e.modal_succeed_callback&&e.modal_succeed_callback()}),this),this.modal_node.active=!1},t.hide=function(){this.modal_node.active=!1},t.defaultCloseCallback=function(){this.hide()},t.show=function(t,e,n){var o=this;void 0===e&&(e=null),void 0===n&&(n=null),n=Object.assign({},{type:"text",content:t,succeed_callback:e||this.defaultCloseCallback},n),this._baseModalShow(n,(function(t,e){var n=e.getChildByPath("panel/content/text_content"),a=e.getChildByPath("panel/content/scroll_content");t.scroll_height?(a.active=!0,console.log(t.content),a.getChildByPath("view/content/text").getComponent(l).string=t.content,n.active=!1,console.log(a.getComponent(i).contentSize),a.getComponent(i).setContentSize(a.getComponent(i).contentSize.width,t.scroll_height),o.setScrollSize(a,t)):(a.active=!1,n.getComponent(l).string=t.content,n.active=!0)}))},t.setScrollSize=function(t,e){t.getChildByPath("view").getComponent(i).setContentSize(e.modal_width-100,e.scroll_height),t.getChildByPath("view/content").getComponent(i).setContentSize(e.modal_width-100-30,e.scroll_height),t.getComponent(i).setContentSize(e.modal_width-100,e.scroll_height)},t._baseModalShow=function(t,e){t=Object.assign({type:"radio",title:"提示",content:"",succeed_callback:null,cancel_callback:this.defaultCloseCallback,disable_cancel_btn:!1,disable_primary_btn:!1,cancel_btn_text:"关闭",primary_btn_text:"知道了",scroll_height:0,change_callback:null,radio_options:[],current_value:null,radio_is_dark:!1,radio_is_vertical:!1,modal_width:500},t),this.modal_node.getChildByPath("panel/title").getComponent(l).string=t.title,this.modal_node.getChildByPath("panel").getComponent(i).setContentSize(t.modal_width,this.modal_node.getChildByPath("panel").getComponent(i).contentSize.height),this.modal_node.getChildByPath("panel/content/text_content").getComponent(i).setContentSize(t.modal_width-100,this.modal_node.getChildByPath("panel/content/text_content").getComponent(i).contentSize.height),this.modal_node.getChildByPath("panel/content/text_content").getComponent(i).setContentSize(t.modal_width-100,this.modal_node.getChildByPath("panel/content/text_content").getComponent(i).contentSize.height),this.modal_succeed_callback=t.succeed_callback,this.modal_cancel_callback=t.cancel_callback,e(t,this.modal_node),this.modal_node.getChildByPath("panel/footer/btn_cancel_wrap/btn/text").getComponent(l).string=t.cancel_btn_text,this.modal_node.getChildByPath("panel/footer/btn_primary_wrap/btn/text").getComponent(l).string=t.primary_btn_text,this.modal_node.getChildByPath("panel/footer/btn_cancel_wrap").active=!t.disable_cancel_btn,this.modal_node.getChildByPath("panel/footer/btn_primary_wrap").active=!t.disable_primary_btn,this.modal_node.active=!0},t.radio=function(t,e,n,o){var a=this;void 0===n&&(n=null),void 0===o&&(o=null),o=Object.assign({},{type:"radio",radio_options:t,current_value:n,change_callback:e,disable_primary_btn:!0,cancel_callback:function(){a.radio_node.parent=null,a.radio_node.destroy(),a.hide()}},o),this._baseModalShow(o,(function(t,e){var n=e.getChildByPath("panel/content/text_content"),o=e.getChildByPath("panel/content/scroll_content"),r=n;t.radio_is_vertical&&(t.radio_options.length<=5?t.scroll_height=50+70*t.radio_options.length:t.scroll_height=Math.max(t.scroll_height,200)),t.scroll_height?(r=o.getChildByPath("view/content"),o.active=!0,console.log(t.content),o.getChildByPath("view/content/text").getComponent(l).string="",n.active=!1,console.log(o.getComponent(i).contentSize),o.getComponent(i).setContentSize(o.getComponent(i).contentSize.width,t.scroll_height),a.setScrollSize(o,t)):(o.active=!1,n.getComponent(l).string="",n.active=!0),a.radio_node=c.create({options:t.radio_options,value:t.current_value,prefab:d.prefab("checkbox_group"),parent_node:r,onchange:t.change_callback,is_dark:t.radio_is_dark,is_vertical:t.radio_is_vertical})}))},t.formCLoseCallback=function(){this.form_node.parent=null,this.form_node.destroy(),this.hide()},t.form=function(t,e,n){var o=this;void 0===n&&(n=null),n=Object.assign({},{type:"form",change_callback:e,disable_primary_btn:!0,cancel_callback:this.formCLoseCallback},n),this._baseModalShow(n,(function(e,n){var a=n.getChildByPath("panel/content/text_content"),c=n.getChildByPath("panel/content/scroll_content"),h=a,_=70;for(var s in t){var g=t[s],p=60;"radio"===g.type&&g.is_vertical&&(p=60*g.options.length),_+=p}e.scroll_height=_,e.scroll_height?(h=c.getChildByPath("view/content"),c.active=!0,console.log(e.content),c.getChildByPath("view/content/text").getComponent(l).string="",a.active=!1,console.log(c.getComponent(i).contentSize),c.getComponent(i).setContentSize(c.getComponent(i).contentSize.width,e.scroll_height),o.setScrollSize(c,e)):(c.active=!1,a.getComponent(l).string="",a.active=!0),o.form_node=r.create({form_params:t,parent_node:h,prefab:d.prefab("form"),is_dark:e.is_dark,onchange:function(t){console.log(t)}})}))},t}()).modal_node=null,_.modal_succeed_callback=null,_.modal_cancel_callback=null,_.radio_node=void 0,_.form_node=void 0,h=_))||h);e._RF.pop()}}}));

System.register("chunks:///_virtual/moveEditor.ts",["./rollupPluginModLoBabelHelpers.js","cc","./stage_editor.ts"],(function(t){var e,n,i,o,s,a,r,l,p,h,d,c,u,g,y,v,b;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){s=t.cclegacy,a=t._decorator,r=t.Node,l=t.Label,p=t.EditBox,h=t.TweenSystem,d=t.Sprite,c=t.tween,u=t.v3,g=t.instantiate,y=t.Component},function(t){v=t.GlobalData,b=t.eventTarget}],execute:function(){var m,f,C,Y,E;s._RF.push({},"bccafuJbM9P87x/DsIO+uXH","moveEditor",void 0);var _=a.ccclass,P=a.property;t("moveEditor",(m=_("moveEditor"),f=P(r),m((E=e((Y=function(t){function e(){for(var e,n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return(e=t.call.apply(t,[this].concat(s))||this).types=["固定位置","匀速下移","指定排数"],e.type="固定位置",e.posY=0,e.speed=20,e.rowNum=3,e.targetY=-500,i(e,"bubble_panel",E,o(e)),e.panel=null,e}n(e,t);var s=e.prototype;return s.init=function(t){this.type=t.type,this.posY=t.posY,this.speed=t.speed,this.rowNum=t.rowNum,this.targetY=t.targetY,this.updateType()},s.shaftType=function(){var t=this.types.indexOf(this.type);(t+=1)>=this.types.length&&(t=0),this.type=this.types[t],this.updateType()},s.updateType=function(){this.node.getChildByPath("Button").children[0].getComponent(l).string=this.type;var t=this.node.getChildByPath("panel/label1").getComponent(l),e=this.node.getChildByPath("panel/label2").getComponent(l),n=this.node.getChildByName("EditBox").getComponent(p),i=this.node.getChildByName("EditBox-001").getComponent(p);switch(this.node.getChildByName("EditBox0").getComponent(p).string=this.posY.toString(),this.type){case"固定位置":t.node.active=!1,e.node.active=!1,n.node.active=!1,i.node.active=!1;break;case"匀速下移":t.node.active=!0,e.node.active=!0,n.node.active=!0,i.node.active=!0,t.string="下移速度",n.editingDidEnded[0].customEventData="speed",n.string=this.speed.toString(),i.string=this.targetY.toString();break;case"指定排数":t.node.active=!0,e.node.active=!1,n.node.active=!0,i.node.active=!1,t.string="排数",n.string=this.rowNum.toString(),n.editingDidEnded[0].customEventData="rowNum"}},s.preview=function(){var t=this;h.instance.ActionManager.removeAllActionsFromTarget(this.node),this.panel.children.forEach((function(t){t.getComponent(d).enabled=!0})),this.panel.setPosition(0,this.posY),console.log(this.posY);var e=function(e){var n=t.panel.getPosition();n.y-=t.speed*e,t.panel.setPosition(n),n.y<=t.targetY&&t.unscheduleAllCallbacks()};this.unschedule(e);"固定位置"==this.type||("匀速下移"==this.type?this.schedule(e.bind(this)):"指定排数"==this.type&&c(this.node).call((function(){for(var e=null,n=[],i=Math.round(1080/v.stage_json.first_line_bubble_num)*Math.cos(30*Math.PI/180),o=t.panel.children.length-1;o>=0;o--){var s=t.panel.children[o];if(s.getComponent(d).enabled){if(e||(e=s.getPosition().y),!(s.getPosition().y<=e+2*i))break;n.push(s)}}0==n.length&&h.instance.ActionManager.removeAllActionsFromTarget(t.node),n.forEach((function(t){t.type=0,t.getComponent(d).enabled=!1}))})).delay(.3).call((function(){c(t.panel).by(.5,{position:u(0,-Math.round(1080/v.stage_json.first_line_bubble_num)*Math.cos(30*Math.PI/180)*3)}).start()})).delay(1).union().repeatForever().start())},s.onClickClose=function(){this.node.active=!1},s.onEnable=function(){this.panel=g(this.bubble_panel),this.node.addChild(this.panel)},s.onDisable=function(){this.panel.destroy()},s.EditBoxEvent=function(t,e){this[e]=Number(t.string),"posY"==e&&(this.panel.setPosition(0,this.posY),b.emit("updatePanel",this.posY))},s.getMoveSetting=function(){return{type:this.type,posY:this.posY,speed:this.speed,rowNum:this.rowNum,targetY:this.targetY}},e}(y)).prototype,"bubble_panel",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=Y))||C));s._RF.pop()}}}));

System.register("chunks:///_virtual/play.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AudioManager.ts","./MathCalc.ts","./BubbleCom.ts","./CrossEdgePosCom.ts","./CurvePathCalc.ts","./ResourceHelper.ts","./ModalHelper.ts","./DrawHelper.ts","./line.ts","./stage_editor.ts","./video.ts"],(function(t){var e,n,i,o,s,l,a,r,h,_,c,u,d,g,p,b,f,v,m,C,y,P,B,j,w,S,E,N,F,L,A,W,x,H,T,D,M;return{setters:[function(t){e=t.inheritsLoose,n=t.createForOfIteratorHelperLoose,i=t.asyncToGenerator,o=t.regeneratorRuntime},function(t){s=t.cclegacy,l=t._decorator,a=t.view,r=t.UITransform,h=t.size,_=t.NodeEventType,c=t.Vec3,u=t.Node,d=t.Camera,g=t.v3,p=t.tween,b=t.instantiate,f=t.Sprite,v=t.UIOpacity,m=t.Intersection2D,C=t.v2,y=t.Animation,P=t.Component,B=t.Prefab,j=t.SpriteFrame,w=t.AudioClip,S=t.JsonAsset},function(t){E=t.AudioManager},function(t){N=t.MathCalc},function(t){F=t.BubbleCom},function(t){L=t.CrossEdgePosCom},function(t){A=t.CurvePathCalc},function(t){W=t.ResourceHelper},function(t){x=t.ModalHelper},function(t){H=t.DrawHelper},function(t){T=t.line},function(t){D=t.GlobalData},function(t){M=t.video}],execute:function(){var z;s._RF.push({},"7d84byzNY5PNZ/EGaEINIWs","play",void 0);var O=l.ccclass;l.property,t("play",O("play")(z=function(t){function s(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).line_node=null,e.const_var={first_line_bubble_num:23,single_ball_diameter:46,bullet_speed:20},e.game_over=!1,e.launch_node=null,e.launch_first_ball_node=null,e.launch_second_ball_node=null,e.bubble_panel_node=null,e.touch_panel_node=null,e.is_first_ball_active=!0,e.is_rolling=!1,e.is_hitting=!1,e.stage_json=null,e.toggle_time=.3,e.clear_time=.3,e.current_hitting_ball_node=void 0,e.all_ball_nums=[3,6,4],e.touch_panel_pos={top:new c,right:new c,bottom:new c,left:new c},e.curve_calc=void 0,e.dest_trace_points=void 0,e.dest_trace_bubble_com=void 0,e.launch_default_ball_world_pos=void 0,e.rate=0,e.bubbleNum=0,e.started=!1,e.bottom=null,e}e(s,t);var l=s.prototype;return l.onLoad=function(){var t=i(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.rate=a.getVisibleSize().x/1080,console.log("start-game"),t.next=4,W.init({res_map:{prefabs:B,imgs:j,audios:w,stage_data:S}});case 4:E.instance.init({bg_music_node_name:"bg_music",bg_music_clip:W.audio("bgm"),bg_volume:.8,parent_node:this.node},!0),x.init({parent_node:this.node,prefab:W.prefab("modal")}),this.stage_json=D.stage_json,this.stage_json.setting.move.speed=this.stage_json.setting.move.speed*this.rate,this.const_var.bullet_speed=this.stage_json.setting.flySpeed*this.rate,this.const_var.first_line_bubble_num=this.stage_json.first_line_bubble_num,D.bgSp&&(this.node.getChildByPath("bg/bubble_bg").getComponent(f).spriteFrame=D.bgSp),D.url&&this.node.getChildByName("bg/bubble_bg").getComponent(M).loadVideo(D.url),this.all_ball_nums=this.stage_json.setting.ballArr.filter((function(t){return t>0})),this.init(),this.startGame(),this.bottom=this.getBottom();case 16:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),l.randomBubbleNum=function(){var t=this.all_ball_nums[this.bubbleNum++];return this.bubbleNum>=this.all_ball_nums.length&&(this.bubbleNum=0),t},l.randomBubbleSf=function(){var t="bubble"+this.randomBubbleNum();return W.img(t)},l.getNowLaunchBallNode=function(t){return void 0===t&&(t=!0),t?this.is_first_ball_active?this.launch_first_ball_node:this.launch_second_ball_node:this.is_first_ball_active?this.launch_second_ball_node:this.launch_first_ball_node},l.init=function(){var t=this;this.const_var.single_ball_diameter=Math.round(a.getVisibleSize().x/this.const_var.first_line_bubble_num),this.launch_node=this.node.getChildByPath("launcher"),this.launch_first_ball_node=this.launch_node.getChildByPath("bubble-first-pole/bubble-first"),this.launch_second_ball_node=this.launch_node.getChildByPath("bubble-second-pole/bubble-second"),this.launch_first_ball_node.getComponent(r).setContentSize(h(this.const_var.single_ball_diameter,this.const_var.single_ball_diameter)),this.launch_second_ball_node.getComponent(r).setContentSize(h(this.const_var.single_ball_diameter,this.const_var.single_ball_diameter)),this.launch_node.on(_.TOUCH_END,this.toggleBall,this),this.launch_first_ball_node.on(_.TOUCH_END,this.toggleBall,this),this.launch_second_ball_node.on(_.TOUCH_END,this.toggleBall,this),this.launch_default_ball_world_pos=this.launch_first_ball_node.getWorldPosition(),this.bubble_panel_node=this.node.getChildByPath("bubble_panel_wrap/Mask/bubble_panel"),this.touch_panel_node=this.node.getChildByPath("bubble_panel_wrap/touch_panel");var e=this.touch_panel_node.getComponent(r).contentSize,n=this.touch_panel_node.getWorldPosition();this.touch_panel_pos={top:null,right:null,bottom:new c(n.x+e.width/2-this.const_var.single_ball_diameter/2,n.y-e.height/2),left:new c(n.x-e.width/2+this.const_var.single_ball_diameter/2,n.y-e.height/2)},this.touch_panel_node.on(u.EventType.TOUCH_END,(function(e){t.clearLine();var n=t.node.getChildByName("Camera").getComponent(d).screenToWorld(g(e.getLocation().x,e.getLocation().y));n.z=0,t.panelClicked(n)}),this),this.started=!0},l.toggleBall=function(t){var e=this;if(this.is_rolling)return!1;this.is_rolling=!0;var n=this.toggle_time,i=this.launch_node.getChildByPath("bubble-first-pole").angle+180,o=this.launch_node.getChildByPath("bubble-second-pole").angle+180;this.is_first_ball_active||(i=this.launch_node.getChildByPath("bubble-first-pole").angle+180,o=this.launch_node.getChildByPath("bubble-second-pole").angle+180),E.instance.playSoundEffect(W.audio("effect_soft_toggle")),p(this.launch_node.getChildByPath("ring")).by(n,{angle:360}).start(),p(this.launch_node.getChildByPath("bubble-first-pole")).to(n,{angle:i}).start(),p(this.launch_node.getChildByPath("bubble-second-pole")).to(n,{angle:o}).start(),this.scheduleOnce((function(){e.is_rolling=!1,e.is_first_ball_active=!e.is_first_ball_active}),n)},l.startGame=function(t){if(void 0===t&&(t=null),this.game_over=!1,!this.initStage(t))return!1;this.setBallNodeToPanel(),H.init(this.node),this.setBubblePanelPos(),this.prepareFireBalls(),this.line_node=b(W.prefab("line"+this.stage_json.setting.line)),this.launch_node.addChild(this.line_node),this.line_node.setSiblingIndex(0)},l.prepareFireBalls=function(){this.launch_first_ball_node.getComponent(f).spriteFrame=this.randomBubbleSf(),this.launch_second_ball_node.getComponent(f).spriteFrame=this.randomBubbleSf()},l.setBubblePanelPos=function(){var t=this.singleH(),e=this.stage_json.points.length,n=this.stage_json.setting.move.posY*this.rate;console.log(this.rate,this.stage_json.setting.move.posY);e>26&&(n+=t*(e-26)*this.const_var.single_ball_diameter),this.bubble_panel_node.setPosition(0,n,0);var i=this.bubble_panel_node.getWorldPosition(),o=this.touch_panel_node.getComponent(r).contentSize;this.touch_panel_pos.top=new c(i.x-o.width/2+this.const_var.single_ball_diameter/2,i.y),this.touch_panel_pos.right=new c(i.x+o.width/2-this.const_var.single_ball_diameter/2,i.y)},l.singleH=function(){return Math.cos(30*Math.PI/180)},l.setBallNodeToPanel=function(){for(var t,e=this.singleH(),i=n(this.stage_json.points);!(t=i()).done;)for(var o,s=t.value,l=n(s);!(o=l()).done;){var a=o.value;if(!a.node){var r=.5;s.length<this.const_var.first_line_bubble_num&&(r=1);var h=new c((a.x-this.const_var.first_line_bubble_num/2+r)*this.const_var.single_ball_diameter,-a.y*this.const_var.single_ball_diameter*e,0),_=this.addNewBallNode(this.bubble_panel_node,!0);_.setPosition(h),0!==a.type&&(_.getComponent(f).spriteFrame=W.img("bubble"+a.type)),a.node=_,a=F.wrap(a)}}},l.addNewBallNode=function(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=null);var i=new u;i.parent=t;var o=i.addComponent(f);return n&&(o.spriteFrame=n,i.name=n.name),o.sizeMode=f.SizeMode.CUSTOM,i.getComponent(r).setContentSize(h(this.const_var.single_ball_diameter,this.const_var.single_ball_diameter)),i.active=e,i.addComponent(v),i.addChild(b(W.prefab("bomb"))),i},l.addOneLineEmptyBalls=function(){var t,e=[],n=this.stage_json.points[this.stage_json.points.length-2];t=n?n.length:this.stage_json.points[0].length-1;for(var i=this.stage_json.points[this.stage_json.points.length-1][0].y+1,o=0;o<t;o++)e.push({type:0,x:o,y:i});this.stage_json.points.push(e)},l.initStage=function(t){return console.log(this.stage_json),this.addOneLineEmptyBalls(),!0},l.panelClicked=function(t){if(this.is_rolling)return!1;if(this.is_hitting)return!1;if(this.game_over)return!1;this.is_hitting=!0;var e=this.getNowLaunchBallNode();this.current_hitting_ball_node=this.addNewBallNode(this.bubble_panel_node,!1,e.getComponent(f).spriteFrame),E.instance.playSoundEffect(W.audio("effect_bubble_launch"),1),e.active=!1,this.calcTrace(t)},l.calcTrace=function(t){for(var e=this.getLineCollideDest(this.launch_default_ball_world_pos.clone(),t),n=[],i=0;i<e.length;i++){var o=e[i];n.length||n.push(o.line_start_pos),i===e.length-1?(this.dest_trace_bubble_com=o.attach_bubble_com,n.push(o.attach_aid_pos)):n.push(o.cross_pos)}this.dest_trace_points=n,this.curve_calc=A.create(n,!0)},l.getLineCollideDest=function(t,e,n,i){var o=this;if(void 0===n&&(n=[]),void 0===i&&(i=!1),n.length>4)return n;var s=this.getCrossPosByFireTouch(e,t),l=s.cross_pos,a=[];if(this.getAllEdgeBallsWithAdjacents().forEach((function(e){m.pointLineDistance(C(e.obj.node.getWorldPosition().x,e.obj.node.getWorldPosition().y),C(t.x,t.y),C(l.x,l.y),!1)<=o.const_var.single_ball_diameter/2&&a.push(e)})),a.length)i?this.getLineEndPos(t,l,a,s):this.bindAttachBallAndDestBallPos(a,t,l,s);else if(s.is_top){var r={o:null,len:null};this.stage_json.points[0].filter((function(t){return 0===t.type})).forEach((function(t,e){var n=t.node.getWorldPosition().subtract(s.cross_pos).length();r.o?n<r.len&&(r.o=t,r.len=n):(r.o=t,r.len=n)})),s.attach_aid_pos=r.o.node.getWorldPosition(),s.attach_bubble_com=r.o}else{var h=s.cross_pos.clone(),_=e.clone().subtract(t);_.x=-_.x;var c=h.clone().add(_);this.getLineCollideDest(h,c,n,i)}return n.unshift(s),n},l.getLineEndPos=function(t,e,n,i){var o={o:null,len:null};n.forEach((function(e,i){if(0===i)return o={o:n[0],len:c.distance(e.obj.node.getWorldPosition(),t)},!1;var s=c.distance(e.obj.node.getWorldPosition(),t);s<o.len&&(o={o:e,len:s})}));var s=N.findFirstIntersection(t,e,o.o.obj.node.getWorldPosition(),this.const_var.single_ball_diameter/2);return i.attach_aid_pos=s,i},l.bindAttachBallAndDestBallPos=function(t,e,n,i){var o={o:null,len:null};t.forEach((function(n,i){if(0===i)return o={o:t[0],len:c.distance(t[0].obj.node.getWorldPosition(),e)},!1;var s=c.distance(n.obj.node.getWorldPosition(),e);s<o.len&&(o={o:n,len:s})}));var s,l=N.getPedalPoint(e,n,o.o.obj.node.getWorldPosition()),a=l.clone().subtract(o.o.obj.node.getWorldPosition()).length(),r=N.getOneLegByOtherLegAndHypotenuse(a,this.const_var.single_ball_diameter),h=N.getPosByRayAndStartPos(l,e,r);o.o.all_adjacent_balls.filter((function(t){return 0===t.type})).forEach((function(t){var e=t.node.getWorldPosition().clone().subtract(h).length();(!s||e<s.offset)&&(s={o:t,offset:e})})),s||console.log("既然已经找到擦边球了，不该走到这一步吧"),i.attach_aid_pos=h,i.attach_bubble_com=s.o},l.getCrossPosByFireTouch=function(t,e){var n=new L;n.line_start_pos=e,n.relative_pos=t;var i=this.touch_panel_pos.top,o=this.touch_panel_pos.left;N.getAngleByDirection(t.clone().subtract(e))<90&&(i=this.touch_panel_pos.right,o=this.touch_panel_pos.bottom);var s=N.getTwoLineCrossPointPos(i,o,e,t);return s?(n.start_pos=i,n.end_pos=o,n.cross_pos=s,n.is_top=!1):(s=N.getTwoLineCrossPointPos(this.touch_panel_pos.top,this.touch_panel_pos.right,e,t),n.start_pos=this.touch_panel_pos.top,n.end_pos=this.touch_panel_pos.right,n.cross_pos=s,n.is_top=!0),n},l.getAllEdgeBallsWithAdjacents=function(){for(var t=[],e=0;e<this.stage_json.points.length;e++)for(var n=this.stage_json.points[e],i=0;i<n.length;i++){var o=n[i];if(0!==o.type){var s=this.getSingleBallWithAdjacents(e,i);s.find((function(t){return 0===t.type}))&&t.push({obj:o,all_adjacent_balls:s})}}return t},l.getSingleBallWithAdjacents=function(t,e){var n=[],i=t%2==0?e-1:e;return t>0&&(n.push(this.stage_json.points[t-1][i]),n.push(this.stage_json.points[t-1][i+1])),n.push(this.stage_json.points[t][e-1]),n.push(this.stage_json.points[t][e+1]),t<this.stage_json.points.length-1&&(n.push(this.stage_json.points[t+1][i]),n.push(this.stage_json.points[t+1][i+1])),n=n.filter((function(t){return!!t}))},l.curvePathFinished=function(){var t=i(o().mark((function t(){var e,n,i=this;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.current_hitting_ball_node.getComponent(f).spriteFrame,this.dest_trace_bubble_com.node.getComponent(f).spriteFrame=e,this.dest_trace_bubble_com.type=parseInt(this.current_hitting_ball_node.getComponent(f).spriteFrame.name.substring(6)),n=this.recursiveGetSiblings(this.dest_trace_bubble_com),this.current_hitting_ball_node.active=!1,n.length>2?(this.recursiveClear(this.dest_trace_bubble_com,[],(function(){var t=i.getAllToDropBalls();t.length?i.scheduleOnce((function(){i.dropBall(t),i.scheduleOnce((function(){i.resetHitting()}),3*i.clear_time)}),i.clear_time):i.resetHitting()})),E.instance.playSoundEffect(W.audio("effect_bubble_explode"),.6)):this.resetHitting();case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),l.getAllToDropBalls=function(){for(var t,e=this,i=[],o=n(this.stage_json.points[0]);!(t=o()).done;){var s=t.value;this.recursiveGetSiblings(s,!0,i)}for(var l=[],a=0;a<this.stage_json.points.length;a++)for(var r=0;r<this.stage_json.points[a].length;r++){this.stage_json.points[a][r].type>0&&!i.find((function(t){return t.node.uuid===e.stage_json.points[a][r].node.uuid}))&&l.push(this.stage_json.points[a][r])}return l},l.recursiveGetSiblings=function(t,e,n){var i=this;if(void 0===e&&(e=!1),void 0===n&&(n=null),null===n&&(n=[]),0===t.type)return!1;if(this.hasAddedSiblings(t,n))return!1;n.push(t);var o=this.getSingleBallWithAdjacents(t.y,t.x);return(o=e?o.filter((function(t){return t.type>0})):o.filter((function(e){return e.type===t.type}))).forEach((function(t){i.hasAddedSiblings(t,n)||i.recursiveGetSiblings(t,e,n)})),n},l.recursiveClear=function(t,e,n){var i=this;if(void 0===e&&(e=[]),0!==t.type)if(this.hasAddedSiblings(t,e))n();else{switch(e.push(t),this.stage_json.setting.clearEffect.type){case"掉落":var o=new u;this.node.addChild(o),o.setWorldPosition(t.node.getWorldPosition()),o.addComponent(f).spriteFrame=t.node.getComponent(f).spriteFrame,o.getComponent(r).contentSize=t.node.getComponent(r).contentSize;var s=0;t.node.getComponent(f).spriteFrame=null,p(o).to(5/this.stage_json.setting.clearEffect.speed,{},{onUpdate:function(t,e){s+=10*e;var n=o.getPosition();n.y-=s*e,o.setPosition(n)}}).call((function(){o.destroy()})).start();break;case"消失":p(t.node.getComponent(v)).to(1/this.stage_json.setting.clearEffect.speed,{opacity:0}).call((function(){t.node.getComponent(v).opacity=255,t.node.getComponent(f).spriteFrame=null})).start();break;case"爆炸":t.node.getComponent(f).spriteFrame=null,t.node.children[0].getComponent(y).getState("bomb").speed=this.stage_json.setting.clearEffect.speed,t.node.children[0].getComponent(y).play()}var l=t.type;t.type=0,this.scheduleOnce((function(){var o=i.getSingleBallWithAdjacents(t.y,t.x).filter((function(t){return t.type===l})),s=o.length;0!==s?o.forEach((function(t){i.hasAddedSiblings(t,e)?0===--s&&n():i.recursiveClear(t,e,(function(){0===--s&&n()}))})):n()}),this.stage_json.setting.clearEffect.interval)}else n()},l.hasAddedSiblings=function(t,e){return e.filter((function(e){return e.node.uuid===t.node.uuid})).length},l.resetHitting=function(){var t=this,e=this.getBottom();if(console.log(e,this.bottom),e<this.bottom-2||0==e){var n=-this.const_var.single_ball_diameter*Math.cos(30*Math.PI/180)*(this.bottom-e);console.log(n),p(this.bubble_panel_node).by(.5,{position:g(0,n)}).start(),this.bottom=e}this.curve_calc=null;var i=this.getNowLaunchBallNode();this.toggleBall(),this.scheduleOnce((function(){i.active=!0,i.getComponent(f).spriteFrame=t.randomBubbleSf(),t.is_hitting=!1}),this.toggle_time)},l.getBottom=function(){for(var t,e=0,i=n(this.stage_json.points);!(t=i()).done;)for(var o,s=t.value,l=n(s);!(o=l()).done;){var a=o.value;if(a.type>0){e=a.y;break}}return e},l.updateHandle=function(){if(this.game_over)return!1;this.is_hitting&&this.current_hitting_ball_node&&this.curve_calc&&!this.curve_calc.is_finished&&(this.curve_calc.moveForward(this.const_var.bullet_speed),this.curve_calc.is_finished?this.curvePathFinished():(this.current_hitting_ball_node.setWorldPosition(this.curve_calc.current_pos),this.current_hitting_ball_node.active=!0))},l.update=function(t){if(this.started){this.updateHandle();var e=this.bubble_panel_node.getPosition();"匀速下移"==this.stage_json.setting.move.type&&e.y>this.stage_json.setting.move.targetY&&(e.y-=this.stage_json.setting.move.speed*t,this.bubble_panel_node.setPosition(e))}},l.dropBall=function(t){var e=this;t.forEach((function(t){var n=new u;n.addComponent(f).spriteFrame=t.node.getComponent(f).spriteFrame,n.getComponent(r).contentSize=t.node.getComponent(r).contentSize,e.node.addChild(n),n.setWorldPosition(t.node.getWorldPosition()),t.type=0,t.node.getComponent(f).spriteFrame=null;var i=3*Math.random()+3;p(n).to(5,{angle:0},{onUpdate:function(t,e){i+=10*e;var o=n.getPosition();o.y-=i,n.setPosition(o)}}).call((function(){n.destroy()})).start()}))},l.drawLine=function(t){this.clearLine();for(var e=this.node.getChildByName("Camera").getComponent(d).screenToWorld(g(t.getLocation().x,t.getLocation().y)),n=this.getLineCollideDest(this.launch_default_ball_world_pos.clone(),e,[],!0),i=[],o=0;o<n.length;o++){var s=n[o];i.length||i.push(s.line_start_pos),o===n.length-1?i.push(s.attach_aid_pos):i.push(s.cross_pos)}this.line_node.getComponent(T).drawLine(i)},l.clearLine=function(){this.line_node.getComponent(T).clearLine()},s}(P))||z);s._RF.pop()}}}));

System.register("chunks:///_virtual/PoolManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,o,n,i,r;return{setters:[function(t){e=t.createClass},function(t){o=t.cclegacy,n=t._decorator,i=t.NodePool,r=t.instantiate}],execute:function(){var a,c;o._RF.push({},"703c5ROTANNf7Yxyrk0rWJj","PoolManager",void 0);var s=n.ccclass;n.property,t("PoolManager",s("PoolManager")(((c=function(){function t(){this.dictPool={},this.dictPrefab={}}var o=t.prototype;return o.getNode=function(t,e,o){void 0===o&&(o=null);var n,r=t.data.name;if(this.dictPrefab[r]=t,this.dictPool.hasOwnProperty(r)){var a=this.dictPool[r];n=a.size()>0?a.get():this.__createNewNode(t,o)}else{var c=new i;this.dictPool[r]=c,n=this.__createNewNode(t,o)}return n.parent=e,n},o.__createNewNode=function(t,e){void 0===e&&(e=null);var o=r(t);return e&&e(o),o},o.putNode=function(t){var e=t.name,o=null;this.dictPool.hasOwnProperty(e)?o=this.dictPool[e]:(o=new i,this.dictPool[e]=o),o.put(t)},o.clearPool=function(t){this.dictPool.hasOwnProperty(t)&&this.dictPool[t].clear()},e(t,null,[{key:"instance",get:function(){return this._instance||(this._instance=new t),this._instance}}]),t}())._instance=void 0,a=c))||a);o._RF.pop()}}}));

System.register("chunks:///_virtual/ResourceHelper.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var r,n,t,u,s,a,c,i;return{setters:[function(e){r=e.asyncToGenerator,n=e.regeneratorRuntime},function(e){t=e.cclegacy,u=e._decorator,s=e.Prefab,a=e.SpriteFrame,c=e.AudioClip,i=e.assetManager}],execute:function(){var o,p;t._RF.push({},"ebe88L7009DM5PMBcGtCXup","ResourceHelper",void 0);var f=u.ccclass;u.property,e("ResourceHelper",f("ResourceHelper")(((p=function(){function e(){}return e.getSingleAssetBundle=function(){var e=r(n().mark((function e(r,t,u){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,n){u.loadDir(r,t,(function(r,t){r?n(r):e(t)}))}));case 2:return e.abrupt("return",this.resources[r]=e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(r,n,t){return e.apply(this,arguments)}}(),e.prefab=function(e){return this.getByName(e,"prefabs")},e.img=function(e){return this.getByName(e,"imgs")},e.audio=function(e){return this.getByName(e,"audios")},e.getByName=function(e,r){return this.resources[r].find((function(r){return r.name===e}))},e.init=function(){var e=r(n().mark((function e(t){var u=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=null),t=Object.assign({res_map:{prefabs:s,imgs:a,audios:c}},t),e.next=4,new Promise((function(e,s){i.loadBundle("resources",r(n().mark((function r(a,c){var i,o;return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!a){r.next=4;break}return s(a),console.error(a),r.abrupt("return");case 4:r.t0=n().keys(t.res_map);case 5:if((r.t1=r.t0()).done){r.next=12;break}return i=r.t1.value,o=t.res_map[i],r.next=10,u.getSingleAssetBundle(i,o,c);case 10:r.next=5;break;case 12:e(c);case 13:case"end":return r.stop()}}),r)}))))}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),e}()).resources={},o=p))||o);t._RF.pop()}}}));

System.register("chunks:///_virtual/stage_editor.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ResourceHelper.ts","./ModalHelper.ts","./StageJson.ts","./editor.ts"],(function(t){var e,n,o,i,a,s,r,l,u,_,d,c,h,g,p,m,b,f,v,y,C,S,B,P,w,N,j,x,A,T,E,M;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,o=t.initializerDefineProperty,i=t.assertThisInitialized,a=t.createForOfIteratorHelperLoose,s=t.asyncToGenerator,r=t.regeneratorRuntime},function(t){l=t.cclegacy,u=t.EventTarget,_=t._decorator,d=t.SceneAsset,c=t.EditBox,h=t.Button,g=t.Node,p=t.Sprite,m=t.NodeEventType,b=t.Camera,f=t.v3,v=t.UITransform,y=t.size,C=t.Label,S=t.Vec3,B=t.director,P=t.Component,w=t.Prefab,N=t.SpriteFrame,j=t.AudioClip,x=t.JsonAsset},function(t){A=t.ResourceHelper},function(t){T=t.ModalHelper},function(t){E=t.StageJson},function(t){M=t.editor}],execute:function(){var L,D,I,O,F;l._RF.push({},"96d41d9pMBA1p1zgI+LAOv9","stage_editor",void 0);var z=t("eventTarget",new u),H=_.ccclass,J=_.property,R=(t("stage_editor",(L=H("stage_editor"),D=J(d),L((F=e((O=function(t){function e(){for(var e,n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return e=t.call.apply(t,[this].concat(a))||this,o(e,"playScene",F,i(e)),e.const_var={first_line_bubble_num:23,totle_line:25,single_ball_diameter:50},e.demo_wrap_node=null,e.current_bubble_num=0,e.points_arr=[],e.moving_point_ball_node=void 0,e.add_steps=[],e.single_step_arr=[],e.touch_move_delay_count=0,e.mouse_delay_count=0,e.stage_node=void 0,e.stage_arr=[],e.current_stage_index=0,e.stage_json=void 0,e}n(e,t);var l=e.prototype;return l.onLoad=function(){var t=s(r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,A.init({res_map:{prefabs:w,imgs:N,audios:j,stage_data:x}});case 2:T.init({parent_node:this.node,prefab:A.prefab("modal")}),this.node.getChildByName("setting").active=!0,z.on("updateStage",this.updateStageBydata,this),z.on("updatePanel",this.setBubblePanelPos,this);case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),l.btn_init=function(){var t=this;this.const_var.first_line_bubble_num=Number(this.node.getChildByPath("setting/第一行数量").getComponent(c).string),this.const_var.totle_line=Number(this.node.getChildByPath("setting/行数").getComponent(c).string),this.const_var.single_ball_diameter=Math.round(1080/this.const_var.first_line_bubble_num),this.node.getChildByName("setting").active=!1,this.init(),this.moving_point_ball_node=this.addNewBallNode(this.node,!1),this.node.getChildByPath("bottom/Button").on(h.EventType.CLICK,(function(){t.download("stage"+(t.current_stage_index+1)+".json",t.formatDownloadJsonContent())}),this)},l.formatDownloadJsonContent=function(){for(var t=this.points_arr,e=0,n=this.points_arr.length-1;e<n&&!t[e].find((function(t){return 0!==t.type}));)e++;for(;n>e&&!t[n].find((function(t){return 0!==t.type}));)n--;n++,console.log(e),console.log(n);var o=t.slice(e,n).map((function(t,e){return t.map((function(t,n){return{type:t.type,x:t.x,y:e}}))}));return JSON.stringify({points:o,setting:this.node.getChildByName("editor").getComponent(M).getSetting()},null,2)},l.addNewBallNode=function(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=null);var o=new g;o.parent=t;var i=o.addComponent(p);return n&&(i.spriteFrame=n,o.name=n.name),o.active=e,o},l.setActiveDemo=function(){var t=this;this.demo_wrap_node.children.forEach((function(e){e.name!=="bubble"+t.current_bubble_num?e.setScale(.7,.7):e.setScale(1,1)}))},l.addTouchEvent=function(){var t=this;this.node.getChildByPath("touch_panel").on(m.TOUCH_START,(function(e){t.single_step_arr=[];var n=t.node.getChildByName("Camera").getComponent(b).screenToWorld(f(e.getLocation().x,e.getLocation().y));n.z=0,t.setCurrentMoveBall(n)}),this),this.node.getChildByPath("touch_panel").on(m.TOUCH_MOVE,(function(e){var n=t.node.getChildByName("Camera").getComponent(b).screenToWorld(f(e.getLocation().x,e.getLocation().y));n.z=0,t.setCurrentMoveBall(n)}),this)},l.setCurrentMoveBall=function(t){for(var e,n=null,o=a(this.points_arr);!(e=o()).done;){var i=e.value;if(n)break;for(var s,r=a(i);!(s=r()).done;){var l=s.value;if(l.node.getWorldPosition().subtract(t).length()<this.const_var.single_ball_diameter/2){n=l;break}}}if(n){var u=l.node;u.active=!0,this.setCurrentSF(u),l.type=this.current_bubble_num,n.type=this.current_bubble_num}},l.setCurrentSF=function(t){return t.getComponent(p).spriteFrame=A.img("bubble"+this.current_bubble_num),t.getComponent(v).setContentSize(y(this.const_var.single_ball_diameter,this.const_var.single_ball_diameter)),t},l.download=function(t,e){var n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),n.setAttribute("download",t),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)},l.defaultStageJson=function(){return{first_line_bubble_num:this.const_var.first_line_bubble_num,totle_line:this.const_var.totle_line,points:[],setting:{line:0,ballArr:[0,0,0,0,0,0,0,0,0,0],flySpeed:20,clearEffect:{type:"掉落",interval:.05,speed:1},move:{type:"固定位置",posY:933,speed:20,rowNum:3,targetY:-500}}}},l.updateCurrentStageShow=function(){this.current_bubble_num=0,this.setActiveDemo();var t=this.stage_arr[this.current_stage_index];this.stage_node.getChildByPath("name").getComponent(C).string=t.name;var e=A.getByName(t.name,"stage_data");this.stage_json=E.wrap(e?e.json:this.defaultStageJson()),R.stage_json=this.stage_json},l.updateStageBydata=function(t){this.current_bubble_num=0,this.setActiveDemo(),this.stage_node.getChildByPath("name").getComponent(C).string="读取的数据",this.stage_json=E.wrap(t),this.node.getChildByName("editor").getComponent(M).init(this.stage_json.setting),this.setBubblePanelPos(),this.reInitStage()},l.init=function(){var t=this;this.stage_node=this.node.getChildByPath("bottom/stage"),this.demo_wrap_node=this.node.getChildByPath("top/balls/container"),this.stage_arr=A.resources.stage_data,console.log(this.stage_arr),this.updateCurrentStageShow();var e=this.stage_arr.map((function(t,e){return{text:t.name,value:e}}));this.stage_node.on(m.TOUCH_END,(function(){T.radio(e,(function(e){t.current_stage_index=e,console.log(e),t.updateCurrentStageShow(),t.reInitStage()}),t.current_stage_index,{title:"选择关卡",radio_is_dark:!0,radio_is_vertical:!0})})),this.node.getChildByName("editor").getComponent(M).init(this.stage_json.setting);var n=A.resources.imgs.filter((function(t){return 0===t.name.indexOf("bubble")}));console.log(n),n.forEach((function(e){var n=t.addNewBallNode(t.demo_wrap_node,!0,e);t.setActiveDemo(),n.on(m.TOUCH_START,(function(e){t.current_bubble_num=parseInt(n.name[6]),t.setActiveDemo()}),t)})),this.node.getChildByPath("touch_panel").on(m.MOUSE_MOVE,(function(e){if(t.mouse_delay_count++,t.mouse_delay_count%3!=0)return!1;var n=t.node.getChildByName("Camera").getComponent(b).screenToWorld(f(e.getLocation().x,e.getLocation().y));n.z=0,t.moving_point_ball_node.setWorldPosition(n),t.setCurrentSF(t.moving_point_ball_node),t.moving_point_ball_node.active=!0}),this),this.node.getChildByPath("touch_panel").on(m.MOUSE_LEAVE,(function(e){t.moving_point_ball_node.active=!1}),this),this.addTouchEvent(),this.setBubblePanelPos(),this.reInitStage(),this.current_bubble_num=1,this.setActiveDemo()},l.setBubblePanelPos=function(t){var e=Math.cos(30*Math.PI/180),n=this.stage_json.points.length;t||(t=this.stage_json.setting.move.posY);n>26&&(t+=e*(n-26)*this.const_var.single_ball_diameter),this.node.getChildByPath("bubble_panel").setPosition(0,t,0)},l.reInitStage=function(){this.points_arr=[];for(var t=Math.cos(30*Math.PI/180),e=0;e<this.const_var.totle_line;e++){for(var n=[],o=0;o<this.const_var.first_line_bubble_num;o++){var i=.5;if(e%2==1){if(o===this.const_var.first_line_bubble_num-1)continue;i=1}var a=new S((o-this.const_var.first_line_bubble_num/2+i)*this.const_var.single_ball_diameter,-e*this.const_var.single_ball_diameter*t,0),s=this.addNewBallNode(this.node.getChildByPath("bubble_panel"),!0);s.setPosition(a),this.setCurrentSF(s),n.push({pos:a,node:s,type:0,x:o,y:e})}this.points_arr.push(n)}this.addStagePointsArr()},l.addStagePointsArr=function(){var t=this;this.stage_json.points.forEach((function(e,n){e.forEach((function(e,o){t.points_arr[n][o].type=e.type,t.points_arr[n][o].node.getComponent(p).spriteFrame=A.img("bubble"+e.type),t.points_arr[n][o].node.getComponent(v).setContentSize(y(t.const_var.single_ball_diameter,t.const_var.single_ball_diameter))}))}))},l.enterGameScene=function(){for(var t=this.points_arr,e=0,n=this.points_arr.length-1;e<n&&!t[e].find((function(t){return 0!==t.type}));)e++;for(;n>e&&!t[n].find((function(t){return 0!==t.type}));)n--;n++;var o=t.slice(e,n).map((function(t,e){return t.map((function(t,n){return{type:t.type,x:t.x,y:e}}))}));this.stage_json.setting=this.node.getChildByName("editor").getComponent(M).getSetting(),this.stage_json.points=o,this.stage_json.first_line_bubble_num=this.const_var.first_line_bubble_num,this.stage_json.totle_line=this.const_var.totle_line,R.stage_json=this.stage_json,B.runScene(this.playScene)},e}(P)).prototype,"playScene",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=O))||I)),t("GlobalData",(function(){})));R.stage_json=void 0,R.bgSp=void 0,R.url=void 0,l._RF.pop()}}}));

System.register("chunks:///_virtual/StageJson.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var n,e,r,o;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,r=t._decorator,o=t.Component}],execute:function(){var i;e._RF.push({},"f1ecaspuN9NSKANmc0nPai/","StageJson",void 0);var s=r.ccclass;r.property,t("StageJson",s("StageJson")(i=function(t){function e(){for(var n,e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return(n=t.call.apply(t,[this].concat(r))||this).setting={line:0,ballArr:[0,0,0,0,0,0,0,0,0,0],flySpeed:20,clearEffect:{type:"掉落",interval:.05,speed:1},move:{type:"固定位置",posY:933,speed:20,rowNum:3,targetY:-500}},n.first_line_bubble_num=23,n.totle_line=25,n.points=[],n._origin_params=void 0,n}return n(e,t),e.wrap=function(t){t=t||{};var n=new e;for(var r in n._origin_params=t,t)n[r]=t[r];return n},e.prototype.toJson=function(t){void 0===t&&(t=!1);var n={};for(var e in this)"function"!=typeof this[e]&&void 0!==this._origin_params[e]&&(n[e]=this[e]);return t?JSON.stringify(n,null,2):n},e}(o))||i);e._RF.pop()}}}));

System.register("chunks:///_virtual/Util.ts",["cc"],(function(t){var e,n,o,r;return{setters:[function(t){e=t.cclegacy,n=t._decorator,o=t.Vec3,r=t.math}],execute:function(){var c;e._RF.push({},"e67c2ctiddDa5A7lq6lYiRP","Util",void 0);var i=n.ccclass;n.property,t("Util",i("Util")(c=function(){function t(){}return t.getVec3ByJsonObj=function(t){return new o(t.x,t.y,t.z)},t.getColor=function(t,e){void 0===e&&(e=1);var n=new r.Color,o=(255*e).toString(16);return 1===o.length&&(o="0"+o),o=o.toUpperCase(),r.Color.fromHEX(n,t+o),n},t.download=function(t,e){var n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),n.setAttribute("download",t),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)},t}())||c);e._RF.pop()}}}));

System.register("chunks:///_virtual/video.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,i,n,o,r,a,s,l,d,h,c,u,v;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,a=e._decorator,s=e.Node,l=e.UITransform,d=e.RenderTexture,h=e.ImageAsset,c=e.Texture2D,u=e.Sprite,v=e.Component}],execute:function(){var m,p,g,E,f;r._RF.push({},"62c38mkKTFNCaY+L6t/9nfZ","video",void 0);var x=a.ccclass,y=a.property;e("video",(m=x("video"),p=y(s),m((f=t((E=function(e){function t(){for(var t,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"targetNode",f,o(t)),t.videoElement=null,t.canvas=null,t.context=null,t.texture=null,t}i(t,e);var r=t.prototype;return r.loadVideo=function(e){this.targetNode?(this.createVideoElement(e),this.setupRenderTexture()):console.log("未设置目标节点")},r.createVideoElement=function(e){this.videoElement=document.createElement("video"),this.videoElement.src=e,this.videoElement.autoplay=!0,this.videoElement.loop=!0,this.videoElement.muted=!0,this.videoElement.play(),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d")},r.setupRenderTexture=function(){if(this.targetNode&&this.videoElement){var e=this.targetNode.getComponent(l);if(e){this.canvas.width=e.width,this.canvas.height=e.height,this.texture=new d,this.texture.reset({width:this.canvas.width,height:this.canvas.height});var t=new h,i=new c;i.image=t,this.targetNode.getComponent(u).spriteFrame.texture=i,this.updateVideoFrame()}}else console.error("未找到目标 Sprite 或 Video 元素")},r.updateVideoFrame=function(){var e=this;if(this.videoElement&&this.context&&this.texture){!function t(){if(e.videoElement.readyState>=e.videoElement.HAVE_CURRENT_DATA){e.context.drawImage(e.videoElement,0,0,e.canvas.width,e.canvas.height);var i=new h(e.canvas),n=new c;n.image=i,e.targetNode.getComponent(u).spriteFrame.texture.destroy(),e.targetNode.getComponent(u).spriteFrame.texture=n}requestAnimationFrame(t)}()}},r.onDestroy=function(){this.videoElement&&(this.videoElement.pause(),this.videoElement.src="",this.videoElement=null),this.canvas&&(this.canvas=null,this.context=null),this.texture&&(this.texture.destroy(),this.texture=null)},t}(v)).prototype,"targetNode",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=E))||g));r._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});